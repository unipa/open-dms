{"version":3,"file":"Viewer.js","names":["Injector","core","Viewer","constructor","options","injector","_init","modules","config","createInjector","get","invoke","fire","destroy","eventBus","clear","bootstrapModules","concat","init"],"sources":["../../../src/base/viewer/Viewer.js"],"sourcesContent":["import { Injector } from 'didi';\r\n\r\nimport core from './core';\r\n\r\n\r\n/**\r\n * A base for React-style viewers.\r\n */\r\nexport default class Viewer {\r\n\r\n  constructor(options = {}) {\r\n    let {\r\n      injector\r\n    } = options;\r\n\r\n    if (!injector) {\r\n      let { modules, config } = this._init(options);\r\n\r\n      injector = createInjector(config, modules);\r\n    }\r\n\r\n    this.get = injector.get;\r\n\r\n    this.invoke = injector.invoke;\r\n\r\n    this.get('eventBus').fire('viewer.init');\r\n  }\r\n\r\n  /**\r\n   * Intialize and return modules and config used for creation.\r\n   *\r\n   * @param  {Object} options\r\n   *\r\n   * @return {Object} { modules=[], config }\r\n   */\r\n  _init(options) {\r\n    let {\r\n      modules,\r\n      ...config\r\n    } = options;\r\n\r\n    return { modules, config };\r\n  }\r\n\r\n  /**\r\n   * Destroy. This results in removing the attachment from the container.\r\n   */\r\n  destroy() {\r\n    const eventBus = this.get('eventBus');\r\n\r\n    eventBus.fire('viewer.destroy');\r\n  }\r\n\r\n  /**\r\n   * Clear. Should be used to reset the state of any stateful services.\r\n   */\r\n  clear() {\r\n    const eventBus = this.get('eventBus');\r\n\r\n    eventBus.fire('viewer.clear');\r\n  }\r\n\r\n}\r\n\r\n\r\n// helpers //////////////////////\r\n\r\nfunction createInjector(config, modules) {\r\n  const bootstrapModules = [\r\n    {\r\n      config: [ 'value', config ]\r\n    },\r\n    core\r\n  ].concat(modules || []);\r\n\r\n  const injector = new Injector(bootstrapModules);\r\n\r\n  injector.init();\r\n\r\n  return injector;\r\n}\r\n"],"mappings":";;;AAAA,SAASA,QAAQ,QAAQ,MAAM;AAE/B,OAAOC,IAAI,MAAM,QAAQ;;AAGzB;AACA;AACA;AACA,eAAe,MAAMC,MAAM,CAAC;EAE1BC,WAAW,GAAe;IAAA,IAAdC,OAAO,uEAAG,CAAC,CAAC;IACtB,IACEC,QAAQ,GACND,OAAO,CADTC,QAAQ;IAGV,IAAI,CAACA,QAAQ,EAAE;MACb,kBAA0B,IAAI,CAACC,KAAK,CAACF,OAAO,CAAC;QAAvCG,OAAO,eAAPA,OAAO;QAAEC,MAAM,eAANA,MAAM;MAErBH,QAAQ,GAAGI,cAAc,CAACD,MAAM,EAAED,OAAO,CAAC;IAC5C;IAEA,IAAI,CAACG,GAAG,GAAGL,QAAQ,CAACK,GAAG;IAEvB,IAAI,CAACC,MAAM,GAAGN,QAAQ,CAACM,MAAM;IAE7B,IAAI,CAACD,GAAG,CAAC,UAAU,CAAC,CAACE,IAAI,CAAC,aAAa,CAAC;EAC1C;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACEN,KAAK,CAACF,OAAO,EAAE;IACb,IACEG,OAAO,GAELH,OAAO,CAFTG,OAAO;MACJC,MAAM,4BACPJ,OAAO;IAEX,OAAO;MAAEG,OAAO;MAAEC;IAAO,CAAC;EAC5B;;EAEA;AACF;AACA;EACEK,OAAO,GAAG;IACR,MAAMC,QAAQ,GAAG,IAAI,CAACJ,GAAG,CAAC,UAAU,CAAC;IAErCI,QAAQ,CAACF,IAAI,CAAC,gBAAgB,CAAC;EACjC;;EAEA;AACF;AACA;EACEG,KAAK,GAAG;IACN,MAAMD,QAAQ,GAAG,IAAI,CAACJ,GAAG,CAAC,UAAU,CAAC;IAErCI,QAAQ,CAACF,IAAI,CAAC,cAAc,CAAC;EAC/B;AAEF;;AAGA;;AAEA,SAASH,cAAc,CAACD,MAAM,EAAED,OAAO,EAAE;EACvC,MAAMS,gBAAgB,GAAG,CACvB;IACER,MAAM,EAAE,CAAE,OAAO,EAAEA,MAAM;EAC3B,CAAC,EACDP,IAAI,CACL,CAACgB,MAAM,CAACV,OAAO,IAAI,EAAE,CAAC;EAEvB,MAAMF,QAAQ,GAAG,IAAIL,QAAQ,CAACgB,gBAAgB,CAAC;EAE/CX,QAAQ,CAACa,IAAI,EAAE;EAEf,OAAOb,QAAQ;AACjB"}