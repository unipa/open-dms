{"version":3,"file":"IdsUtil.js","names":["SPACE_REGEX","QNAME_REGEX","ID_REGEX","PLACEHOLDER_REGEX","validateId","businessObject","id","assigned","$model","ids","idExists","validateIdFormat","stripPlaceholders","containsSpace","test","value","replace"],"sources":["../../src/util/IdsUtil.js"],"sourcesContent":["const SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nconst QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nconst ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\nconst PLACEHOLDER_REGEX = /\\$\\{([^}]*)\\}/g;\n\n/**\n * Validates an ID.\n *\n * @param {ModdleElement} businessObject\n * @param {string} id\n *\n * @return {string} error message\n */\nexport function validateId(businessObject, id) {\n  const assigned = businessObject.$model.ids.assigned(id);\n\n  const idExists = assigned && assigned !== businessObject;\n\n  if (!id) {\n    return 'Element must have ID.';\n  }\n\n  if (idExists) {\n    return 'Element must have unique ID.';\n  }\n\n  return validateIdFormat(id);\n}\n\n\nfunction validateIdFormat(id) {\n\n  id = stripPlaceholders(id);\n\n  if (containsSpace(id)) {\n    return 'Id must not contain spaces.';\n  }\n\n  if (!ID_REGEX.test(id)) {\n\n    if (QNAME_REGEX.test(id)) {\n      return 'Id must not contain prefix.';\n    }\n\n    return 'Id must be a valid QName.';\n  }\n}\n\n\nfunction containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}\n\n\nfunction stripPlaceholders(id) {\n\n  // replace expression e.g. ${VERSION_TAG}\n  // use only the content between ${}\n  // for the REGEX check\n  return id.replace(PLACEHOLDER_REGEX, '$1');\n}"],"mappings":"AAAA,MAAMA,WAAW,GAAG,IAAI;;AAExB;AACA,MAAMC,WAAW,GAAG,kCAAkC;;AAEtD;AACA,MAAMC,QAAQ,GAAG,kBAAkB;AAEnC,MAAMC,iBAAiB,GAAG,gBAAgB;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,UAAU,CAACC,cAAc,EAAEC,EAAE,EAAE;EAC7C,MAAMC,QAAQ,GAAGF,cAAc,CAACG,MAAM,CAACC,GAAG,CAACF,QAAQ,CAACD,EAAE,CAAC;EAEvD,MAAMI,QAAQ,GAAGH,QAAQ,IAAIA,QAAQ,KAAKF,cAAc;EAExD,IAAI,CAACC,EAAE,EAAE;IACP,OAAO,uBAAuB;EAChC;EAEA,IAAII,QAAQ,EAAE;IACZ,OAAO,8BAA8B;EACvC;EAEA,OAAOC,gBAAgB,CAACL,EAAE,CAAC;AAC7B;AAGA,SAASK,gBAAgB,CAACL,EAAE,EAAE;EAE5BA,EAAE,GAAGM,iBAAiB,CAACN,EAAE,CAAC;EAE1B,IAAIO,aAAa,CAACP,EAAE,CAAC,EAAE;IACrB,OAAO,6BAA6B;EACtC;EAEA,IAAI,CAACJ,QAAQ,CAACY,IAAI,CAACR,EAAE,CAAC,EAAE;IAEtB,IAAIL,WAAW,CAACa,IAAI,CAACR,EAAE,CAAC,EAAE;MACxB,OAAO,6BAA6B;IACtC;IAEA,OAAO,2BAA2B;EACpC;AACF;AAGA,SAASO,aAAa,CAACE,KAAK,EAAE;EAC5B,OAAOf,WAAW,CAACc,IAAI,CAACC,KAAK,CAAC;AAChC;AAGA,SAASH,iBAAiB,CAACN,EAAE,EAAE;EAE7B;EACA;EACA;EACA,OAAOA,EAAE,CAACU,OAAO,CAACb,iBAAiB,EAAE,IAAI,CAAC;AAC5C"}