{"version":3,"file":"IdUnclaimBehavior.js","names":["CommandInterceptor","isArray","IdUnclaimBehavior","constructor","eventBus","modeling","_modeling","preExecute","event","context","element","row","col","unclaimId","businessObject","cells","forEach","cell","id","$descriptor","properties","property","value","name","v","$type","$inject"],"sources":["../../../../src/features/modeling/behavior/IdUnclaimBehavior.js"],"sourcesContent":["import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport { isArray } from 'min-dash';\r\n\r\n\r\nexport default class IdUnclaimBehavior extends CommandInterceptor {\r\n\r\n  constructor(eventBus, modeling) {\r\n    super(eventBus);\r\n\r\n    this._modeling = modeling;\r\n\r\n    this.preExecute([ 'row.remove', 'col.remove' ], event => {\r\n      const context = event.context,\r\n            element = context.row || context.col;\r\n\r\n      this.unclaimId(element.businessObject);\r\n\r\n      if (element.cells) {\r\n        element.cells.forEach(cell => this.unclaimId(cell.businessObject));\r\n      }\r\n    });\r\n  }\r\n\r\n  unclaimId(businessObject) {\r\n\r\n    if (businessObject.id) {\r\n      this._modeling.unclaimId(businessObject.id, businessObject);\r\n    }\r\n\r\n    businessObject.$descriptor.properties.forEach(property => {\r\n      const value = businessObject[property.name];\r\n\r\n      // not set\r\n      if (!value) {\r\n        return;\r\n      }\r\n\r\n      // array of moddle elements\r\n      if (isArray(value)) {\r\n        value.forEach(v => this.unclaimId(v));\r\n      }\r\n\r\n      // moddle element\r\n      if (value.$type) {\r\n        this.unclaimId(value);\r\n      }\r\n    });\r\n\r\n  }\r\n}\r\n\r\nIdUnclaimBehavior.$inject = [ 'eventBus', 'modeling' ];"],"mappings":"AAAA,OAAOA,kBAAkB,MAAM,2CAA2C;AAE1E,SAASC,OAAO,QAAQ,UAAU;AAGlC,eAAe,MAAMC,iBAAiB,SAASF,kBAAkB,CAAC;EAEhEG,WAAW,CAACC,QAAQ,EAAEC,QAAQ,EAAE;IAC9B,KAAK,CAACD,QAAQ,CAAC;IAEf,IAAI,CAACE,SAAS,GAAGD,QAAQ;IAEzB,IAAI,CAACE,UAAU,CAAC,CAAE,YAAY,EAAE,YAAY,CAAE,EAAEC,KAAK,IAAI;MACvD,MAAMC,OAAO,GAAGD,KAAK,CAACC,OAAO;QACvBC,OAAO,GAAGD,OAAO,CAACE,GAAG,IAAIF,OAAO,CAACG,GAAG;MAE1C,IAAI,CAACC,SAAS,CAACH,OAAO,CAACI,cAAc,CAAC;MAEtC,IAAIJ,OAAO,CAACK,KAAK,EAAE;QACjBL,OAAO,CAACK,KAAK,CAACC,OAAO,CAACC,IAAI,IAAI,IAAI,CAACJ,SAAS,CAACI,IAAI,CAACH,cAAc,CAAC,CAAC;MACpE;IACF,CAAC,CAAC;EACJ;EAEAD,SAAS,CAACC,cAAc,EAAE;IAExB,IAAIA,cAAc,CAACI,EAAE,EAAE;MACrB,IAAI,CAACZ,SAAS,CAACO,SAAS,CAACC,cAAc,CAACI,EAAE,EAAEJ,cAAc,CAAC;IAC7D;IAEAA,cAAc,CAACK,WAAW,CAACC,UAAU,CAACJ,OAAO,CAACK,QAAQ,IAAI;MACxD,MAAMC,KAAK,GAAGR,cAAc,CAACO,QAAQ,CAACE,IAAI,CAAC;;MAE3C;MACA,IAAI,CAACD,KAAK,EAAE;QACV;MACF;;MAEA;MACA,IAAIrB,OAAO,CAACqB,KAAK,CAAC,EAAE;QAClBA,KAAK,CAACN,OAAO,CAACQ,CAAC,IAAI,IAAI,CAACX,SAAS,CAACW,CAAC,CAAC,CAAC;MACvC;;MAEA;MACA,IAAIF,KAAK,CAACG,KAAK,EAAE;QACf,IAAI,CAACZ,SAAS,CAACS,KAAK,CAAC;MACvB;IACF,CAAC,CAAC;EAEJ;AACF;AAEApB,iBAAiB,CAACwB,OAAO,GAAG,CAAE,UAAU,EAAE,UAAU,CAAE"}