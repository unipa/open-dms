{"version":3,"file":"UpdateAllowedValuesHandler.js","names":["is","UpdateAllowedValuesHandler","constructor","dmnFactory","moddle","modeling","_dmnFactory","_moddle","_modeling","execute","context","element","allowedValues","isInput","inputValues","oldAllowedValues","text","isNull","create","join","outputValues","revert","$inject","value"],"sources":["../../../../src/features/modeling/cmd/UpdateAllowedValuesHandler.js"],"sourcesContent":["import { is } from 'dmn-js-shared/lib/util/ModelUtil';\n\n/**\n * A handler that implements adding/removing allowed values.\n */\nexport default class UpdateAllowedValuesHandler {\n\n  constructor(dmnFactory, moddle, modeling) {\n    this._dmnFactory = dmnFactory;\n    this._moddle = moddle;\n    this._modeling = modeling;\n  }\n\n  /**\n   * <do>\n   */\n  execute(context) {\n    const {\n      element,\n      allowedValues\n    } = context;\n\n    const isInput = is(element, 'dmn:InputClause');\n\n    if (isInput) {\n\n      if (element.inputValues) {\n        context.oldAllowedValues = element.inputValues.text;\n      } else {\n\n        if (!isNull(allowedValues)) {\n          element.inputValues = this._dmnFactory.create('dmn:UnaryTests', {\n            text: ''\n          });\n        }\n\n      }\n\n      if (isNull(allowedValues)) {\n        if (element.inputValues) {\n          delete element.inputValues;\n        }\n      } else {\n        element.inputValues.text = allowedValues.join(',');\n      }\n\n    } else {\n\n      if (element.outputValues && element) {\n        context.oldAllowedValues = element.outputValues.text;\n      } else {\n\n        if (!isNull(allowedValues)) {\n          element.outputValues = this._dmnFactory.create('dmn:UnaryTests', {\n            text: ''\n          });\n        }\n\n      }\n\n      if (isNull(allowedValues)) {\n        if (element.outputValues) {\n          delete element.outputValues;\n        }\n      } else {\n        element.outputValues.text = allowedValues.join(',');\n      }\n\n\n    }\n\n    return element;\n  }\n\n\n  /**\n   * <undo>\n   */\n  revert(context) {\n    const {\n      element,\n      oldAllowedValues\n    } = context;\n\n    const isInput = is(element, 'dmn:InputClause');\n\n    if (isInput) {\n\n      if (oldAllowedValues) {\n\n        if (!element.inputValues) {\n          element.inputValues = this._dmnFactory.create('dmn:UnaryTests', {\n            text: ''\n          });\n        }\n\n        element.inputValues.text = oldAllowedValues;\n\n      } else {\n        delete element.inputValues;\n      }\n\n    } else {\n\n      if (oldAllowedValues) {\n\n        if (!element.outputValues) {\n          element.outputValues = this._dmnFactory.create('dmn:UnaryTests', {\n            text: ''\n          });\n        }\n\n        element.outputValues.text = oldAllowedValues;\n\n      } else {\n        delete element.outputValues;\n      }\n\n    }\n\n    return element;\n  }\n\n}\n\nUpdateAllowedValuesHandler.$inject = [\n  'dmnFactory',\n  'moddle',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction isNull(value) {\n  return value === null;\n}"],"mappings":"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"}