{"version":3,"file":"InputTimeEdit.js","names":["Component","ValidatedInput","InputSelect","getTimeString","getSampleTime","validateISOString","parseString","getSampleDate","EXACT","BEFORE","AFTER","BETWEEN","InputTimeEdit","constructor","props","context","_translate","injector","get","_modeling","element","parsedString","businessObject","text","times","time","state","type","debounceInput","debouncedEditCell","editCell","bind","onTypeChange","onSetStartTimeNowClick","onSetEndTimeNowClick","onStartTimeInput","onEndTimeInput","cell","value","setState","render","options","label","example","string"],"sources":["../../../../src/features/simple-time-edit/components/InputTimeEdit.js"],"sourcesContent":["import { Component } from 'inferno';\n\nimport ValidatedInput from 'dmn-js-shared/lib/components/ValidatedInput';\n\nimport InputSelect from 'dmn-js-shared/lib/components/InputSelect';\n\nimport {\n  getTimeString,\n  getSampleTime,\n  validateISOString,\n  parseString\n} from '../Utils';\nimport { getSampleDate } from '../../simple-date-edit/Utils';\n\nconst EXACT = 'exact',\n      BEFORE = 'before',\n      AFTER = 'after',\n      BETWEEN = 'between';\n\n\nexport default class InputTimeEdit extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this._translate = context.injector.get('translate');\n    this._modeling = context.injector.get('modeling');\n\n    const { element } = this.props.context;\n\n    const parsedString = parseString(element.businessObject.text);\n\n    if (parsedString) {\n      let times;\n\n      if (parsedString.time) {\n        times = [ parsedString.time, '' ];\n      } else if (parsedString.times) {\n        times = parsedString.times;\n      } else {\n        times = [ '', '' ];\n      }\n\n      this.state = {\n        type: parsedString.type,\n        times: times\n      };\n    } else {\n      this.state = {\n        type: EXACT,\n        times: [ '', '' ]\n      };\n    }\n\n    const debounceInput = context.injector.get('debounceInput');\n\n    this.debouncedEditCell = debounceInput(this.editCell.bind(this));\n    this.editCell = this.editCell.bind(this);\n\n    this.onTypeChange = this.onTypeChange.bind(this);\n    this.onSetStartTimeNowClick = this.onSetStartTimeNowClick.bind(this);\n    this.onSetEndTimeNowClick = this.onSetEndTimeNowClick.bind(this);\n    this.onStartTimeInput = this.onStartTimeInput.bind(this);\n    this.onEndTimeInput = this.onEndTimeInput.bind(this);\n  }\n\n  editCell(cell, text) {\n    this._modeling.editCell(cell, text);\n  }\n\n  onTypeChange(value) {\n    const { element } = this.props.context;\n\n    const { times } = this.state;\n\n    this.setState({\n      type: value\n    });\n\n    if (parseString(getTimeString(value, times))) {\n      this.editCell(element.businessObject, getTimeString(value, times));\n    }\n  }\n\n  onSetStartTimeNowClick() {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    const time = getSampleTime();\n\n    this.setState({\n      times: [ time, times[1] ]\n    });\n\n    if (parseString(getTimeString(type, [ time, times[1] ]))) {\n      this.editCell(element.businessObject, getTimeString(type, [ time, times[1] ]));\n    }\n  }\n\n  onSetEndTimeNowClick() {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    const time = getSampleTime();\n\n    this.setState({\n      times: [ times[0], time ]\n    });\n\n    if (parseString(getTimeString(type, [ times[0], time ]))) {\n      this.editCell(element.businessObject, getTimeString(type, [ times[0], time ]));\n    }\n  }\n\n  onStartTimeInput({ value }) {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    this.setState({\n      times: [ value, times[1] ]\n    });\n\n    this.debouncedEditCell(\n      element.businessObject,\n      getTimeString(type, [ value, times[1] ])\n    );\n  }\n\n  onEndTimeInput({ value }) {\n    const { element } = this.props.context;\n\n    const { times, type } = this.state;\n\n    this.setState({\n      times: [ times[0], value ]\n    });\n\n    this.debouncedEditCell(\n      element.businessObject,\n      getTimeString(type, [ times[0], value ])\n    );\n  }\n\n  render() {\n    const { times, type } = this.state;\n\n    const options = [ {\n      label: this._translate('Exactly'),\n      value: EXACT\n    }, {\n      label: this._translate('Before'),\n      value: BEFORE\n    }, {\n      label: this._translate('After'),\n      value: AFTER\n    }, {\n      label: this._translate('Between'),\n      value: BETWEEN\n    } ];\n\n    return (\n      <div class=\"context-menu-container simple-time-edit\">\n\n        <h3 class=\"dms-heading\">{ this._translate('Edit time') }</h3>\n\n        <div className=\"dms-fill-row\">\n          <InputSelect\n            noInput={ true }\n            onChange={ this.onTypeChange }\n            options={ options }\n            value={ type } />\n        </div>\n\n        <h4 class=\"dms-heading\">\n          {\n            type === BETWEEN\n              ? this._translate('Edit start time')\n              : this._translate('Set time')\n          }\n        </h4>\n\n        <div>\n          <ValidatedInput\n            className=\"start-time-input dms-block\"\n            onInput={ this.onStartTimeInput }\n            placeholder={ this._translate('e.g. { example } ', {\n              example: getSampleDate()\n            }) }\n            validate={ string => validateISOString(string) &&\n              this._translate(validateISOString(string)) }\n            value={ times[0] } />\n\n          <p className=\"dms-hint\">\n            <button type=\"button\"\n              className=\"use-now\"\n              onClick={ this.onSetStartTimeNowClick }>\n              { this._translate('Use now') }\n            </button>.\n          </p>\n        </div>\n\n        {\n          type === BETWEEN\n            && <h4 class=\"dms-heading\">\n              {this._translate('Edit end time')}\n            </h4>\n        }\n\n        {\n          type === BETWEEN\n            && <div>\n              <ValidatedInput\n                className=\"end-time-input dms-block\"\n                onInput={ this.onEndTimeInput }\n                placeholder={ this._translate('e.g. { example } ', {\n                  example: getSampleDate()\n                }) }\n                validate={ string => validateISOString(string) &&\n                  this._translate(validateISOString(string)) }\n                value={ times[1] }>\n              </ValidatedInput>\n\n              <p className=\"dms-hint\">\n                <button type=\"button\"\n                  className=\"use-now\"\n                  onClick={ this.onSetEndTimeNowClick }>\n                  { this._translate('Use now') }\n                </button>.\n              </p>\n            </div>\n        }\n\n      </div>\n    );\n  }\n}"],"mappings":"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"}