{"version":3,"file":"DescriptionEditor.js","names":["Component","isString","query","domQuery","EditableComponent","DescriptionEditor","constructor","props","context","forceUpdate","value","_modeling","updateProperties","_element","description","_elementRegistry","injector","get","_changeSupport","changeSupport","id","componentWillMount","onElementsChanged","componentDidMount","autoFocus","node","editor","getEditor","focus","componentWillUnmount","offElementsChanged","businessObject","length","changeDescription","render","Editor","getClassName","container"],"sources":["../../../../src/features/description/components/DescriptionEditor.js"],"sourcesContent":["import { Component } from 'inferno';\r\n\r\nimport { isString } from 'min-dash';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport EditableComponent from 'dmn-js-shared/lib/components/EditableComponent';\r\n\r\nexport default class DescriptionEditor extends Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n\r\n    this._elementRegistry = context.injector.get('elementRegistry');\r\n    this._modeling = context.injector.get('modeling');\r\n\r\n    this._changeSupport = this.context.changeSupport;\r\n\r\n    const { id } = this.props.context;\r\n\r\n    this._element = this._elementRegistry.get(id);\r\n  }\r\n\r\n  onElementsChanged = () => {\r\n    this.forceUpdate();\r\n  };\r\n\r\n  componentWillMount() {\r\n    if (this._element) {\r\n      this._changeSupport.onElementsChanged(this._element.id, this.onElementsChanged);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { autoFocus } = this.props.context;\r\n\r\n    if (autoFocus && this.node) {\r\n      const editor = getEditor(this.node);\r\n\r\n      editor.focus();\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this._element) {\r\n      this._changeSupport.offElementsChanged(this._element.id, this.onElementsChanged);\r\n\r\n      const { businessObject } = this._element;\r\n\r\n      const { description } = businessObject;\r\n\r\n      // if empty description remove description\r\n      if (isString(description) && !description.length) {\r\n        this.changeDescription(null);\r\n      }\r\n    }\r\n  }\r\n\r\n  changeDescription = (value) => {\r\n    this._modeling.updateProperties(this._element, {\r\n      description: value\r\n    });\r\n  };\r\n\r\n  render() {\r\n    if (!this._element) {\r\n      return;\r\n    }\r\n\r\n    const { businessObject } = this._element;\r\n\r\n    const { description } = businessObject;\r\n\r\n    if (!isString(description)) {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        class=\"context-menu-container description-editor\"\r\n        ref={ node => this.node = node }>\r\n        <Editor\r\n          className=\"dms-input\"\r\n          onChange={ this.changeDescription }\r\n          value={ description } />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass Editor extends EditableComponent {\r\n  render() {\r\n    return (\r\n      <div className={ this.getClassName() }>\r\n        {\r\n          this.getEditor()\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// helpers //////////\r\n\r\nfunction getEditor(container) {\r\n  return domQuery('.content-editable', container);\r\n}"],"mappings":"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"}