{"version":3,"file":"ViewDrd.js","names":["ViewDrdComponent","ViewDrd","constructor","components","eventBus","injector","sheet","_injector","_sheet","onGetComponent","canViewDrd","on","parent","get","root","getRoot","definitions","getDefinitions","view","getView","open","$inject","businessObject","decision","$parent"],"sources":["../../../src/features/view-drd/ViewDrd.js"],"sourcesContent":["import ViewDrdComponent from './components/ViewDrdComponent';\r\n\r\nexport default class ViewDrd {\r\n  constructor(components, eventBus, injector, sheet) {\r\n    this._injector = injector;\r\n    this._sheet = sheet;\r\n\r\n    components.onGetComponent('table.before', () => {\r\n      if (this.canViewDrd()) {\r\n        return ViewDrdComponent;\r\n      }\r\n    });\r\n\r\n    eventBus.on('showDrd', () => {\r\n      const parent = injector.get('_parent', false);\r\n\r\n      const root = sheet.getRoot();\r\n\r\n      const definitions = getDefinitions(root);\r\n\r\n      if (!definitions) {\r\n        return;\r\n      }\r\n\r\n      // open definitions\r\n      const view = parent.getView(definitions);\r\n\r\n      parent.open(view);\r\n    });\r\n  }\r\n\r\n  canViewDrd() {\r\n    const parent = this._injector.get('_parent', false);\r\n\r\n    if (!parent) {\r\n      return false;\r\n    }\r\n\r\n    const root = this._sheet.getRoot();\r\n\r\n    const definitions = getDefinitions(root);\r\n\r\n    return !!parent.getView(definitions);\r\n  }\r\n}\r\n\r\nViewDrd.$inject = [ 'components', 'eventBus', 'injector', 'sheet' ];\r\n\r\n\r\n// helpers //////////////////////\r\n\r\nfunction getDefinitions(root) {\r\n  const { businessObject } = root;\r\n\r\n  // root might not have business object\r\n  if (!businessObject) {\r\n    return;\r\n  }\r\n\r\n  const decision = businessObject.$parent;\r\n\r\n  const definitions = decision.$parent;\r\n\r\n  return definitions;\r\n}"],"mappings":"AAAA,OAAOA,gBAAgB,MAAM,+BAA+B;AAE5D,eAAe,MAAMC,OAAO,CAAC;EAC3BC,WAAW,CAACC,UAAU,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,KAAK,EAAE;IACjD,IAAI,CAACC,SAAS,GAAGF,QAAQ;IACzB,IAAI,CAACG,MAAM,GAAGF,KAAK;IAEnBH,UAAU,CAACM,cAAc,CAAC,cAAc,EAAE,MAAM;MAC9C,IAAI,IAAI,CAACC,UAAU,EAAE,EAAE;QACrB,OAAOV,gBAAgB;MACzB;IACF,CAAC,CAAC;IAEFI,QAAQ,CAACO,EAAE,CAAC,SAAS,EAAE,MAAM;MAC3B,MAAMC,MAAM,GAAGP,QAAQ,CAACQ,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC;MAE7C,MAAMC,IAAI,GAAGR,KAAK,CAACS,OAAO,EAAE;MAE5B,MAAMC,WAAW,GAAGC,cAAc,CAACH,IAAI,CAAC;MAExC,IAAI,CAACE,WAAW,EAAE;QAChB;MACF;;MAEA;MACA,MAAME,IAAI,GAAGN,MAAM,CAACO,OAAO,CAACH,WAAW,CAAC;MAExCJ,MAAM,CAACQ,IAAI,CAACF,IAAI,CAAC;IACnB,CAAC,CAAC;EACJ;EAEAR,UAAU,GAAG;IACX,MAAME,MAAM,GAAG,IAAI,CAACL,SAAS,CAACM,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC;IAEnD,IAAI,CAACD,MAAM,EAAE;MACX,OAAO,KAAK;IACd;IAEA,MAAME,IAAI,GAAG,IAAI,CAACN,MAAM,CAACO,OAAO,EAAE;IAElC,MAAMC,WAAW,GAAGC,cAAc,CAACH,IAAI,CAAC;IAExC,OAAO,CAAC,CAACF,MAAM,CAACO,OAAO,CAACH,WAAW,CAAC;EACtC;AACF;AAEAf,OAAO,CAACoB,OAAO,GAAG,CAAE,YAAY,EAAE,UAAU,EAAE,UAAU,EAAE,OAAO,CAAE;;AAGnE;;AAEA,SAASJ,cAAc,CAACH,IAAI,EAAE;EAC5B,MAAQQ,cAAc,GAAKR,IAAI,CAAvBQ,cAAc;;EAEtB;EACA,IAAI,CAACA,cAAc,EAAE;IACnB;EACF;EAEA,MAAMC,QAAQ,GAAGD,cAAc,CAACE,OAAO;EAEvC,MAAMR,WAAW,GAAGO,QAAQ,CAACC,OAAO;EAEpC,OAAOR,WAAW;AACpB"}