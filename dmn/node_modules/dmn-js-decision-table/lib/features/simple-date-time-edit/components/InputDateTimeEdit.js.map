{"version":3,"file":"InputDateTimeEdit.js","names":["Component","ValidatedInput","InputSelect","getDateString","getSampleDate","validateISOString","parseString","EXACT","BEFORE","AFTER","BETWEEN","InputDateEdit","constructor","props","context","_translate","injector","get","_modeling","element","parsedString","businessObject","text","dates","date","state","type","debounceInput","debouncedEditCell","editCell","bind","onTypeChange","onSetStartDateTodayClick","onSetEndDateTodayClick","onStartDateInput","onEndDateInput","cell","value","setState","render","options","label","sample","string"],"sources":["../../../../src/features/simple-date-time-edit/components/InputDateTimeEdit.js"],"sourcesContent":["import { Component } from 'inferno';\n\nimport ValidatedInput from 'dmn-js-shared/lib/components/ValidatedInput';\n\nimport InputSelect from 'dmn-js-shared/lib/components/InputSelect';\n\nimport {\n  getDateString,\n  getSampleDate,\n  validateISOString,\n  parseString\n} from '../Utils';\n\nconst EXACT = 'exact',\n      BEFORE = 'before',\n      AFTER = 'after',\n      BETWEEN = 'between';\n\n\nexport default class InputDateEdit extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this._translate = context.injector.get('translate');\n    this._modeling = context.injector.get('modeling');\n\n    const { element } = this.props.context;\n\n    const parsedString = parseString(element.businessObject.text);\n\n    if (parsedString) {\n      let dates;\n\n      if (parsedString.date) {\n        dates = [ parsedString.date, '' ];\n      } else if (parsedString.dates) {\n        dates = parsedString.dates;\n      } else {\n        dates = [ '', '' ];\n      }\n\n      this.state = {\n        type: parsedString.type,\n        dates\n      };\n    } else {\n      this.state = {\n        type: EXACT,\n        dates: [ '', '' ]\n      };\n    }\n\n    const debounceInput = context.injector.get('debounceInput');\n\n    this.debouncedEditCell = debounceInput(this.editCell.bind(this));\n    this.editCell = this.editCell.bind(this);\n\n    this.onTypeChange = this.onTypeChange.bind(this);\n    this.onSetStartDateTodayClick = this.onSetStartDateTodayClick.bind(this);\n    this.onSetEndDateTodayClick = this.onSetEndDateTodayClick.bind(this);\n    this.onStartDateInput = this.onStartDateInput.bind(this);\n    this.onEndDateInput = this.onEndDateInput.bind(this);\n  }\n\n  editCell(cell, text) {\n    this._modeling.editCell(cell, text);\n  }\n\n  onTypeChange(value) {\n    const { element } = this.props.context;\n\n    const { dates } = this.state;\n\n    this.setState({\n      type: value\n    });\n\n    if (parseString(getDateString(value, dates))) {\n      this.editCell(element.businessObject, getDateString(value, dates));\n    }\n  }\n\n  onSetStartDateTodayClick() {\n    const { element } = this.props.context;\n\n    const { dates, type } = this.state;\n\n    const date = getSampleDate();\n\n    this.setState({\n      dates: [ date, dates[1] ]\n    });\n\n    if (parseString(getDateString(type, [ date, dates[1] ]))) {\n      this.editCell(element.businessObject, getDateString(type, [ date, dates[1] ]));\n    }\n  }\n\n  onSetEndDateTodayClick() {\n    const { element } = this.props.context;\n\n    const { dates, type } = this.state;\n\n    const date = getSampleDate();\n\n    this.setState({\n      dates: [ dates[0], date ]\n    });\n\n    if (parseString(getDateString(type, [ dates[0], date ]))) {\n      this.editCell(element.businessObject, getDateString(type, [ dates[0], date ]));\n    }\n  }\n\n  onStartDateInput({ value }) {\n    const { element } = this.props.context;\n\n    const { dates, type } = this.state;\n\n    this.setState({\n      dates: [ value, dates[1] ]\n    });\n\n    this.debouncedEditCell(\n      element.businessObject,\n      getDateString(type, [ value, dates[1] ])\n    );\n  }\n\n  onEndDateInput({ value }) {\n    const { element } = this.props.context;\n\n    const { dates, type } = this.state;\n\n    this.setState({\n      dates: [ dates[0], value ]\n    });\n\n    this.debouncedEditCell(\n      element.businessObject,\n      getDateString(type, [ dates[0], value ])\n    );\n  }\n\n  render() {\n    const { dates, type } = this.state;\n\n    const options = [ {\n      label: this._translate('Exactly'),\n      value: EXACT\n    }, {\n      label: this._translate('Before'),\n      value: BEFORE\n    }, {\n      label: this._translate('After'),\n      value: AFTER\n    }, {\n      label: this._translate('Between'),\n      value: BETWEEN\n    } ];\n\n    return (\n      <div class=\"context-menu-container simple-date-edit\">\n\n        <h3 class=\"dms-heading\">{ this._translate('Edit date and time') }</h3>\n\n        <div className=\"dms-fill-row\">\n          <InputSelect\n            noInput={ true }\n            onChange={ this.onTypeChange }\n            options={ options }\n            value={ type } />\n        </div>\n\n        <h4 class=\"dms-heading\">\n          {\n            type === BETWEEN\n              ? this._translate('Edit start date')\n              : this._translate('Set date')\n          }\n        </h4>\n\n        <div>\n          <ValidatedInput\n            className=\"start-date-input dms-block\"\n            onInput={ this.onStartDateInput }\n            placeholder={ this._translate('e.g. { sample }', {\n              sample: getSampleDate()\n            }) }\n            validate={ string => validateISOString(string) &&\n              this._translate(validateISOString(string)) }\n            value={ dates[0] } />\n\n          <p className=\"dms-hint\">\n            <button type=\"button\"\n              className=\"use-today\"\n              onClick={ this.onSetStartDateTodayClick }>\n              { this._translate('Use today') }\n            </button>.\n          </p>\n        </div>\n\n        {\n          type === BETWEEN\n            && <h4 class=\"dms-heading\">\n              { this._translate('Edit end date') }\n            </h4>\n        }\n\n        {\n          type === BETWEEN\n            && <div>\n              <ValidatedInput\n                className=\"end-date-input dms-block\"\n                onInput={ this.onEndDateInput }\n                placeholder={ this._translate('e.g. { sample }', {\n                  sample: getSampleDate()\n                }) }\n                validate={ string => validateISOString(string) &&\n                  this._translate(validateISOString(string)) }\n                value={ dates[1] }>\n              </ValidatedInput>\n\n              <p className=\"dms-hint\">\n                <button type=\"button\"\n                  className=\"use-today\"\n                  onClick={ this.onSetEndDateTodayClick }>\n                  { this._translate('Use today') }\n                </button>.\n              </p>\n            </div>\n        }\n\n      </div>\n    );\n  }\n}"],"mappings":"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"}