{"version":3,"file":"ElementFactory.js","names":["assign","inherits","is","BaseElementFactory","BUSINESS_KNOWLEDGE_MODEL_SIZE","width","height","DECISION_SIZE","INPUT_DATA_SIZE","KNOWLEDGE_SOURCE_SIZE","ElementFactory","drdFactory","call","_drdFactory","$inject","prototype","baseCreate","create","elementType","attrs","createDrdElement","size","businessObject","type","Error","di","createDiEdge","createDiShape","_getDefaultSize","id","semantic"],"sources":["../../../src/features/modeling/ElementFactory.js"],"sourcesContent":["import {\n  assign\n} from 'min-dash';\n\nimport inherits from 'inherits-browser';\n\nimport {\n  is\n} from 'dmn-js-shared/lib/util/ModelUtil';\n\nimport BaseElementFactory from 'diagram-js/lib/core/ElementFactory';\n\nexport var BUSINESS_KNOWLEDGE_MODEL_SIZE = { width: 135, height: 46 };\nexport var DECISION_SIZE = { width: 180, height: 80 };\nexport var INPUT_DATA_SIZE = { width: 125, height: 45 };\nexport var KNOWLEDGE_SOURCE_SIZE = { width: 100, height: 63 };\n\n\n/**\n * A drd-aware factory for diagram-js shapes\n */\nexport default function ElementFactory(drdFactory) {\n  BaseElementFactory.call(this);\n\n  this._drdFactory = drdFactory;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\n\nElementFactory.$inject = [ 'drdFactory' ];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function(elementType, attrs) {\n  return this.createDrdElement(elementType, attrs);\n};\n\nElementFactory.prototype.createDrdElement = function(elementType, attrs) {\n  var drdFactory = this._drdFactory;\n\n  var size;\n\n  attrs = attrs || {};\n\n  var businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error('no shape type specified');\n    }\n\n    businessObject = drdFactory.create(attrs.type);\n  }\n\n  if (!businessObject.di) {\n    if (elementType === 'connection') {\n      businessObject.di = drdFactory.createDiEdge(businessObject, []);\n    } else if (elementType === 'shape') {\n      businessObject.di = drdFactory.createDiShape(businessObject, {});\n    }\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign({\n    businessObject: businessObject,\n    id: businessObject.id\n  }, size, attrs);\n\n  return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(semantic) {\n  if (is(semantic, 'dmn:BusinessKnowledgeModel')) {\n    return BUSINESS_KNOWLEDGE_MODEL_SIZE;\n  }\n\n  if (is(semantic, 'dmn:Decision')) {\n    return DECISION_SIZE;\n  }\n\n  if (is(semantic, 'dmn:InputData')) {\n    return INPUT_DATA_SIZE;\n  }\n\n  if (is(semantic, 'dmn:KnowledgeSource')) {\n    return KNOWLEDGE_SOURCE_SIZE;\n  }\n\n  return { width: 100, height: 80 };\n};\n"],"mappings":"AAAA,SACEA,MAAM,QACD,UAAU;AAEjB,OAAOC,QAAQ,MAAM,kBAAkB;AAEvC,SACEC,EAAE,QACG,kCAAkC;AAEzC,OAAOC,kBAAkB,MAAM,oCAAoC;AAEnE,OAAO,IAAIC,6BAA6B,GAAG;EAAEC,KAAK,EAAE,GAAG;EAAEC,MAAM,EAAE;AAAG,CAAC;AACrE,OAAO,IAAIC,aAAa,GAAG;EAAEF,KAAK,EAAE,GAAG;EAAEC,MAAM,EAAE;AAAG,CAAC;AACrD,OAAO,IAAIE,eAAe,GAAG;EAAEH,KAAK,EAAE,GAAG;EAAEC,MAAM,EAAE;AAAG,CAAC;AACvD,OAAO,IAAIG,qBAAqB,GAAG;EAAEJ,KAAK,EAAE,GAAG;EAAEC,MAAM,EAAE;AAAG,CAAC;;AAG7D;AACA;AACA;AACA,eAAe,SAASI,cAAc,CAACC,UAAU,EAAE;EACjDR,kBAAkB,CAACS,IAAI,CAAC,IAAI,CAAC;EAE7B,IAAI,CAACC,WAAW,GAAGF,UAAU;AAC/B;AAEAV,QAAQ,CAACS,cAAc,EAAEP,kBAAkB,CAAC;AAG5CO,cAAc,CAACI,OAAO,GAAG,CAAE,YAAY,CAAE;AAEzCJ,cAAc,CAACK,SAAS,CAACC,UAAU,GAAGb,kBAAkB,CAACY,SAAS,CAACE,MAAM;AAEzEP,cAAc,CAACK,SAAS,CAACE,MAAM,GAAG,UAASC,WAAW,EAAEC,KAAK,EAAE;EAC7D,OAAO,IAAI,CAACC,gBAAgB,CAACF,WAAW,EAAEC,KAAK,CAAC;AAClD,CAAC;AAEDT,cAAc,CAACK,SAAS,CAACK,gBAAgB,GAAG,UAASF,WAAW,EAAEC,KAAK,EAAE;EACvE,IAAIR,UAAU,GAAG,IAAI,CAACE,WAAW;EAEjC,IAAIQ,IAAI;EAERF,KAAK,GAAGA,KAAK,IAAI,CAAC,CAAC;EAEnB,IAAIG,cAAc,GAAGH,KAAK,CAACG,cAAc;EAEzC,IAAI,CAACA,cAAc,EAAE;IACnB,IAAI,CAACH,KAAK,CAACI,IAAI,EAAE;MACf,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;IAC5C;IAEAF,cAAc,GAAGX,UAAU,CAACM,MAAM,CAACE,KAAK,CAACI,IAAI,CAAC;EAChD;EAEA,IAAI,CAACD,cAAc,CAACG,EAAE,EAAE;IACtB,IAAIP,WAAW,KAAK,YAAY,EAAE;MAChCI,cAAc,CAACG,EAAE,GAAGd,UAAU,CAACe,YAAY,CAACJ,cAAc,EAAE,EAAE,CAAC;IACjE,CAAC,MAAM,IAAIJ,WAAW,KAAK,OAAO,EAAE;MAClCI,cAAc,CAACG,EAAE,GAAGd,UAAU,CAACgB,aAAa,CAACL,cAAc,EAAE,CAAC,CAAC,CAAC;IAClE;EACF;EAEAD,IAAI,GAAG,IAAI,CAACO,eAAe,CAACN,cAAc,CAAC;EAE3CH,KAAK,GAAGnB,MAAM,CAAC;IACbsB,cAAc,EAAEA,cAAc;IAC9BO,EAAE,EAAEP,cAAc,CAACO;EACrB,CAAC,EAAER,IAAI,EAAEF,KAAK,CAAC;EAEf,OAAO,IAAI,CAACH,UAAU,CAACE,WAAW,EAAEC,KAAK,CAAC;AAC5C,CAAC;AAGDT,cAAc,CAACK,SAAS,CAACa,eAAe,GAAG,UAASE,QAAQ,EAAE;EAC5D,IAAI5B,EAAE,CAAC4B,QAAQ,EAAE,4BAA4B,CAAC,EAAE;IAC9C,OAAO1B,6BAA6B;EACtC;EAEA,IAAIF,EAAE,CAAC4B,QAAQ,EAAE,cAAc,CAAC,EAAE;IAChC,OAAOvB,aAAa;EACtB;EAEA,IAAIL,EAAE,CAAC4B,QAAQ,EAAE,eAAe,CAAC,EAAE;IACjC,OAAOtB,eAAe;EACxB;EAEA,IAAIN,EAAE,CAAC4B,QAAQ,EAAE,qBAAqB,CAAC,EAAE;IACvC,OAAOrB,qBAAqB;EAC9B;EAEA,OAAO;IAAEJ,KAAK,EAAE,GAAG;IAAEC,MAAM,EAAE;EAAG,CAAC;AACnC,CAAC"}