{"version":3,"file":"ReplaceMenuProvider.js","names":["is","forEach","filter","replaceOptions","ReplaceMenuProvider","popupMenu","modeling","moddle","drdReplace","rules","translate","_popupMenu","_modeling","_moddle","_drdReplace","_rules","_translate","register","$inject","prototype","registerProvider","getEntries","element","businessObject","allowed","options","DECISION","option","notEmpty","actionName","decisionLogic","notTable","notExp","_createEntries","menuEntries","self","definition","entry","_createMenuEntry","push","action","replaceElement","replaceAction","target","menuEntry","label","className","id","getHeaderEntries"],"sources":["../../../src/features/popup-menu/ReplaceMenuProvider.js"],"sourcesContent":["import {\n  is\n} from 'dmn-js-shared/lib/util/ModelUtil';\n\nimport {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport replaceOptions from '../replace/ReplaceOptions';\n\n\n/**\n * This module is an element agnostic replace menu provider for the popup menu.\n */\nexport default function ReplaceMenuProvider(\n    popupMenu, modeling, moddle,\n    drdReplace, rules, translate) {\n\n  this._popupMenu = popupMenu;\n  this._modeling = modeling;\n  this._moddle = moddle;\n  this._drdReplace = drdReplace;\n  this._rules = rules;\n  this._translate = translate;\n\n  this.register();\n}\n\nReplaceMenuProvider.$inject = [\n  'popupMenu',\n  'modeling',\n  'moddle',\n  'drdReplace',\n  'rules',\n  'translate'\n];\n\n\n/**\n * Register replace menu provider in the popup menu\n */\nReplaceMenuProvider.prototype.register = function() {\n  this._popupMenu.registerProvider('dmn-replace', this);\n};\n\n\n/**\n * Get all entries from replaceOptions for the given element.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getEntries = function(element) {\n\n  var businessObject = element.businessObject;\n\n  var rules = this._rules;\n\n  if (!rules.allowed('shape.replace', { element: element })) {\n    return [];\n  }\n\n  if (is(businessObject, 'dmn:Decision')) {\n\n    var options = filter(replaceOptions.DECISION, function(option) {\n      var notEmpty = (\n        option.actionName === 'replace-with-empty-decision' &&\n        businessObject.decisionLogic\n      );\n      var notTable = (\n        option.actionName === 'replace-with-decision-table' &&\n        !is(businessObject.decisionLogic, 'dmn:DecisionTable')\n      );\n      var notExp = (\n        option.actionName === 'replace-with-literal-expression' &&\n        !is(businessObject.decisionLogic, 'dmn:LiteralExpression')\n      );\n\n      return notEmpty || notTable || notExp;\n    });\n\n    return this._createEntries(element, options);\n  }\n\n  return [];\n};\n\n\n/**\n * Creates an array of menu entry objects for a given element.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createEntries = function(element, replaceOptions) {\n  var menuEntries = [];\n\n  var self = this;\n\n  forEach(replaceOptions, function(definition) {\n    var entry = self._createMenuEntry(definition, element);\n\n    menuEntries.push(entry);\n  });\n\n  return menuEntries;\n};\n\n\n/**\n * Creates and returns a single menu entry item.\n *\n * @param  {Object} definition a single replace options definition object\n * @param  {djs.model.Base} element\n * @param  {Function} [action] an action callback function which gets called when\n *                             the menu entry is being triggered.\n *\n * @return {Object} menu entry item\n */\nReplaceMenuProvider.prototype._createMenuEntry = function(definition, element, action) {\n  var replaceElement = this._drdReplace.replaceElement;\n  var translate = this._translate;\n\n  var replaceAction = function() {\n    return replaceElement(element, definition.target);\n  };\n\n  action = action || replaceAction;\n\n  var menuEntry = {\n    label: translate(definition.label),\n    className: definition.className,\n    id: definition.actionName,\n    action: action\n  };\n\n  return menuEntry;\n};\n\nReplaceMenuProvider.prototype.getHeaderEntries = function(element) {\n  return [];\n};\n"],"mappings":"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"}