{"version":3,"file":"DiGenerator.js","names":["forEach","containsDi","is","DiGenerator","drdFactory","elementFactory","eventBus","drdUpdater","createDi","definitions","dmnDI","create","set","diagram","index","get","drgElement","dimensions","_getDefaultSize","di","createDiShape","x","y","width","height","updateDiParent","on","$inject"],"sources":["../../../src/features/generate-di/DiGenerator.js"],"sourcesContent":["import { forEach } from 'min-dash';\n\nimport { containsDi } from 'dmn-js-shared/lib/util/DiUtil';\nimport { is } from 'dmn-js-shared/lib/util/ModelUtil';\n\n\n/**\n * Generates missing DI on import.\n *\n * @param {DrdFactory} drdFactory\n * @param {ElementFactory} elementFactory\n * @param {EventBus} eventBus\n */\nexport default function DiGenerator(drdFactory, elementFactory, eventBus, drdUpdater) {\n  function createDi(definitions) {\n\n    // retrieve or create dmnDI\n    var dmnDI = definitions.dmnDI;\n\n    if (!dmnDI) {\n      dmnDI = drdFactory.create('dmndi:DMNDI');\n      definitions.set('dmnDI', dmnDI);\n    }\n\n    var diagram = drdFactory.create('dmndi:DMNDiagram');\n\n    dmnDI.set('diagrams', [ diagram ]);\n\n    var index = 0;\n\n    forEach(definitions.get('drgElement'), function(drgElement) {\n\n      // generate DI for decisions only\n      if (!is(drgElement, 'dmn:Decision')) {\n        return;\n      }\n\n\n      var dimensions = elementFactory._getDefaultSize(drgElement);\n\n      var di = drdFactory.createDiShape(drgElement, {\n        x: 150 + (index * 30),\n        y: 150 + (index * 30),\n        width: dimensions.width,\n        height: dimensions.height\n      });\n\n      drdUpdater.updateDiParent(di, diagram);\n\n      index++;\n    });\n  }\n\n  eventBus.on('import.start', ({ definitions }) => {\n    if (!containsDi(definitions)) {\n      createDi(definitions);\n    }\n  });\n}\n\nDiGenerator.$inject = [\n  'drdFactory',\n  'elementFactory',\n  'eventBus',\n  'drdUpdater'\n];"],"mappings":"AAAA,SAASA,OAAO,QAAQ,UAAU;AAElC,SAASC,UAAU,QAAQ,+BAA+B;AAC1D,SAASC,EAAE,QAAQ,kCAAkC;;AAGrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,WAAW,CAACC,UAAU,EAAEC,cAAc,EAAEC,QAAQ,EAAEC,UAAU,EAAE;EACpF,SAASC,QAAQ,CAACC,WAAW,EAAE;IAE7B;IACA,IAAIC,KAAK,GAAGD,WAAW,CAACC,KAAK;IAE7B,IAAI,CAACA,KAAK,EAAE;MACVA,KAAK,GAAGN,UAAU,CAACO,MAAM,CAAC,aAAa,CAAC;MACxCF,WAAW,CAACG,GAAG,CAAC,OAAO,EAAEF,KAAK,CAAC;IACjC;IAEA,IAAIG,OAAO,GAAGT,UAAU,CAACO,MAAM,CAAC,kBAAkB,CAAC;IAEnDD,KAAK,CAACE,GAAG,CAAC,UAAU,EAAE,CAAEC,OAAO,CAAE,CAAC;IAElC,IAAIC,KAAK,GAAG,CAAC;IAEbd,OAAO,CAACS,WAAW,CAACM,GAAG,CAAC,YAAY,CAAC,EAAE,UAASC,UAAU,EAAE;MAE1D;MACA,IAAI,CAACd,EAAE,CAACc,UAAU,EAAE,cAAc,CAAC,EAAE;QACnC;MACF;MAGA,IAAIC,UAAU,GAAGZ,cAAc,CAACa,eAAe,CAACF,UAAU,CAAC;MAE3D,IAAIG,EAAE,GAAGf,UAAU,CAACgB,aAAa,CAACJ,UAAU,EAAE;QAC5CK,CAAC,EAAE,GAAG,GAAIP,KAAK,GAAG,EAAG;QACrBQ,CAAC,EAAE,GAAG,GAAIR,KAAK,GAAG,EAAG;QACrBS,KAAK,EAAEN,UAAU,CAACM,KAAK;QACvBC,MAAM,EAAEP,UAAU,CAACO;MACrB,CAAC,CAAC;MAEFjB,UAAU,CAACkB,cAAc,CAACN,EAAE,EAAEN,OAAO,CAAC;MAEtCC,KAAK,EAAE;IACT,CAAC,CAAC;EACJ;EAEAR,QAAQ,CAACoB,EAAE,CAAC,cAAc,EAAE,QAAqB;IAAA,IAAlBjB,WAAW,QAAXA,WAAW;IACxC,IAAI,CAACR,UAAU,CAACQ,WAAW,CAAC,EAAE;MAC5BD,QAAQ,CAACC,WAAW,CAAC;IACvB;EACF,CAAC,CAAC;AACJ;AAEAN,WAAW,CAACwB,OAAO,GAAG,CACpB,YAAY,EACZ,gBAAgB,EAChB,UAAU,EACV,YAAY,CACb"}