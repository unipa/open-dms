{"version":3,"file":"Importer.js","names":["DrdTreeWalker","importDRD","drd","definitions","done","importer","get","eventBus","error","warnings","render","visitor","root","element","di","add","message","context","push","walker","handleDefinitions","fire","e"],"sources":["../../src/import/Importer.js"],"sourcesContent":["import DrdTreeWalker from './DrdTreeWalker';\n\n\n/**\n * Import the definitions into a diagram.\n *\n * Errors and warnings are reported through the specified callback.\n *\n * @param  {Drd} drd\n * @param  {ModdleElement} definitions\n * @param  {Function} done\n *         the callback, invoked with (err, [ warning ]) once the import is done\n */\nexport function importDRD(drd, definitions, done) {\n\n  var importer = drd.get('drdImporter'),\n      eventBus = drd.get('eventBus');\n\n  var error,\n      warnings = [];\n\n  function render(definitions) {\n\n    var visitor = {\n      root: function(element) {\n        return importer.root(element);\n      },\n\n      element: function(element, di) {\n        return importer.add(element, di);\n      },\n\n      error: function(message, context) {\n        warnings.push({ message: message, context: context });\n      }\n    };\n\n    var walker = new DrdTreeWalker(visitor);\n\n    // import\n    walker.handleDefinitions(definitions);\n  }\n\n  eventBus.fire('import.start', { definitions: definitions });\n\n  try {\n    render(definitions);\n  } catch (e) {\n    error = e;\n  }\n\n  eventBus.fire('import.done', { error: error, warnings: warnings });\n\n  done(error, warnings);\n}"],"mappings":"AAAA,OAAOA,aAAa,MAAM,iBAAiB;;AAG3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,SAAS,CAACC,GAAG,EAAEC,WAAW,EAAEC,IAAI,EAAE;EAEhD,IAAIC,QAAQ,GAAGH,GAAG,CAACI,GAAG,CAAC,aAAa,CAAC;IACjCC,QAAQ,GAAGL,GAAG,CAACI,GAAG,CAAC,UAAU,CAAC;EAElC,IAAIE,KAAK;IACLC,QAAQ,GAAG,EAAE;EAEjB,SAASC,MAAM,CAACP,WAAW,EAAE;IAE3B,IAAIQ,OAAO,GAAG;MACZC,IAAI,EAAE,cAASC,OAAO,EAAE;QACtB,OAAOR,QAAQ,CAACO,IAAI,CAACC,OAAO,CAAC;MAC/B,CAAC;MAEDA,OAAO,EAAE,iBAASA,QAAO,EAAEC,EAAE,EAAE;QAC7B,OAAOT,QAAQ,CAACU,GAAG,CAACF,QAAO,EAAEC,EAAE,CAAC;MAClC,CAAC;MAEDN,KAAK,EAAE,eAASQ,OAAO,EAAEC,OAAO,EAAE;QAChCR,QAAQ,CAACS,IAAI,CAAC;UAAEF,OAAO,EAAEA,OAAO;UAAEC,OAAO,EAAEA;QAAQ,CAAC,CAAC;MACvD;IACF,CAAC;IAED,IAAIE,MAAM,GAAG,IAAInB,aAAa,CAACW,OAAO,CAAC;;IAEvC;IACAQ,MAAM,CAACC,iBAAiB,CAACjB,WAAW,CAAC;EACvC;EAEAI,QAAQ,CAACc,IAAI,CAAC,cAAc,EAAE;IAAElB,WAAW,EAAEA;EAAY,CAAC,CAAC;EAE3D,IAAI;IACFO,MAAM,CAACP,WAAW,CAAC;EACrB,CAAC,CAAC,OAAOmB,CAAC,EAAE;IACVd,KAAK,GAAGc,CAAC;EACX;EAEAf,QAAQ,CAACc,IAAI,CAAC,aAAa,EAAE;IAAEb,KAAK,EAAEA,KAAK;IAAEC,QAAQ,EAAEA;EAAS,CAAC,CAAC;EAElEL,IAAI,CAACI,KAAK,EAAEC,QAAQ,CAAC;AACvB"}