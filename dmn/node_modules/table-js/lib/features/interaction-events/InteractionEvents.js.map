{"version":3,"file":"InteractionEvents.js","names":["closest","domClosest","EVENTS","InteractionEvents","constructor","config","eventBus","event","target","type","node","findClosestCell","elementId","getAttribute","e","_eventBus","createEvent","id","fire","defaultPrevented","preventDefault","cancelBubble","stopPropagation","_container","container","on","_addEventListeners","_removeEventListeners","events","forEach","addEventListener","_handleEvent","removeEventListener","$inject","element"],"sources":["../../../src/features/interaction-events/InteractionEvents.js"],"sourcesContent":["import {\n  closest as domClosest\n} from 'min-dom';\n\nconst EVENTS = [\n  'click',\n  'dblclick',\n  'contextmenu',\n  'mousedown',\n  'mouseup',\n  'mouseenter',\n  'mouseleave',\n  'mouseout',\n  'mouseover',\n  'mousemove',\n  'focusin',\n  'focusout',\n  'drag',\n  'dragstart',\n  'dragend',\n  'dragover',\n  'dragenter',\n  'dragleave',\n  'drop'\n];\n\n\n/**\n * Provides interaction events on the table.\n *\n * @param {RenderConfig} config\n * @param {EventBus} eventBus\n */\nexport default class InteractionEvents {\n\n  constructor(config, eventBus) {\n    this._eventBus = eventBus;\n    this._container = config.container;\n\n    eventBus.on('table.init', () => {\n      this._addEventListeners(EVENTS);\n    });\n\n    eventBus.on('table.destroy', () => {\n      this._removeEventListeners(EVENTS);\n    });\n  }\n\n  _addEventListeners(events) {\n    const container = this._container;\n\n    events.forEach(event => {\n      container.addEventListener(event, this._handleEvent);\n    });\n  }\n\n  _removeEventListeners(events) {\n    const container = this._container;\n\n    events.forEach(event => {\n      container.removeEventListener(event, this._handleEvent);\n    });\n  }\n\n  _handleEvent = (event) => {\n    const { target, type } = event;\n\n    const node = findClosestCell(target);\n\n    if (!node) {\n      return;\n    }\n\n    const elementId = node.getAttribute('data-element-id');\n\n    if (elementId) {\n      const e = this._eventBus.createEvent({\n        id: elementId,\n        event,\n        node,\n        target: node\n      });\n\n      this._eventBus.fire(`cell.${type}`, e);\n\n      if (e.defaultPrevented) {\n        event.preventDefault();\n      }\n\n      if (e.cancelBubble) {\n        event.stopPropagation();\n      }\n    }\n  };\n}\n\nInteractionEvents.$inject = [\n  'config.renderer',\n  'eventBus'\n];\n\n// helpers /////////////\n\nfunction findClosestCell(element) {\n  return domClosest(element, '[data-element-id]', true);\n}"],"mappings":";;AAAA,SACEA,OAAO,IAAIC,UADb,QAEO,SAFP;AAIA,MAAMC,MAAM,GAAG,CACb,OADa,EAEb,UAFa,EAGb,aAHa,EAIb,WAJa,EAKb,SALa,EAMb,YANa,EAOb,YAPa,EAQb,UARa,EASb,WATa,EAUb,WAVa,EAWb,SAXa,EAYb,UAZa,EAab,MAba,EAcb,WAda,EAeb,SAfa,EAgBb,UAhBa,EAiBb,WAjBa,EAkBb,WAlBa,EAmBb,MAnBa,CAAf;AAuBA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,MAAMC,iBAAN,CAAwB;EAErCC,WAAW,CAACC,MAAD,EAASC,QAAT,EAAmB;IAAA,sCA6BdC,KAAD,IAAW;MACxB,MAAM;QAAEC,MAAF;QAAUC;MAAV,IAAmBF,KAAzB;MAEA,MAAMG,IAAI,GAAGC,eAAe,CAACH,MAAD,CAA5B;;MAEA,IAAI,CAACE,IAAL,EAAW;QACT;MACD;;MAED,MAAME,SAAS,GAAGF,IAAI,CAACG,YAAL,CAAkB,iBAAlB,CAAlB;;MAEA,IAAID,SAAJ,EAAe;QACb,MAAME,CAAC,GAAG,KAAKC,SAAL,CAAeC,WAAf,CAA2B;UACnCC,EAAE,EAAEL,SAD+B;UAEnCL,KAFmC;UAGnCG,IAHmC;UAInCF,MAAM,EAAEE;QAJ2B,CAA3B,CAAV;;QAOA,KAAKK,SAAL,CAAeG,IAAf,CAAqB,QAAOT,IAAK,EAAjC,EAAoCK,CAApC;;QAEA,IAAIA,CAAC,CAACK,gBAAN,EAAwB;UACtBZ,KAAK,CAACa,cAAN;QACD;;QAED,IAAIN,CAAC,CAACO,YAAN,EAAoB;UAClBd,KAAK,CAACe,eAAN;QACD;MACF;IACF,CA1D6B;;IAC5B,KAAKP,SAAL,GAAiBT,QAAjB;IACA,KAAKiB,UAAL,GAAkBlB,MAAM,CAACmB,SAAzB;IAEAlB,QAAQ,CAACmB,EAAT,CAAY,YAAZ,EAA0B,MAAM;MAC9B,KAAKC,kBAAL,CAAwBxB,MAAxB;IACD,CAFD;IAIAI,QAAQ,CAACmB,EAAT,CAAY,eAAZ,EAA6B,MAAM;MACjC,KAAKE,qBAAL,CAA2BzB,MAA3B;IACD,CAFD;EAGD;;EAEDwB,kBAAkB,CAACE,MAAD,EAAS;IACzB,MAAMJ,SAAS,GAAG,KAAKD,UAAvB;IAEAK,MAAM,CAACC,OAAP,CAAetB,KAAK,IAAI;MACtBiB,SAAS,CAACM,gBAAV,CAA2BvB,KAA3B,EAAkC,KAAKwB,YAAvC;IACD,CAFD;EAGD;;EAEDJ,qBAAqB,CAACC,MAAD,EAAS;IAC5B,MAAMJ,SAAS,GAAG,KAAKD,UAAvB;IAEAK,MAAM,CAACC,OAAP,CAAetB,KAAK,IAAI;MACtBiB,SAAS,CAACQ,mBAAV,CAA8BzB,KAA9B,EAAqC,KAAKwB,YAA1C;IACD,CAFD;EAGD;;AA7BoC;AA+DvC5B,iBAAiB,CAAC8B,OAAlB,GAA4B,CAC1B,iBAD0B,EAE1B,UAF0B,CAA5B,C,CAKA;;AAEA,SAAStB,eAAT,CAAyBuB,OAAzB,EAAkC;EAChC,OAAOjC,UAAU,CAACiC,OAAD,EAAU,mBAAV,EAA+B,IAA/B,CAAjB;AACD"}