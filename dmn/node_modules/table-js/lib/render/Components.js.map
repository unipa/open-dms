{"version":3,"file":"Components.js","names":["isFunction","isNumber","DEFAULT_PRIORITY","Components","constructor","_listeners","getComponent","type","context","listeners","component","i","length","callback","getComponents","components","push","onGetComponent","priority","Error","_getListeners","existingListener","idx","newListener","splice","offGetComponent","listener","listenerCallback"],"sources":["../../src/render/Components.js"],"sourcesContent":["import {\n  isFunction,\n  isNumber\n} from 'min-dash';\n\nconst DEFAULT_PRIORITY = 1000;\n\n\nexport default class Components {\n\n  constructor() {\n    this._listeners = {};\n  }\n\n  getComponent(type, context) {\n    const listeners = this._listeners[type];\n\n    if (!listeners) {\n      return;\n    }\n\n    let component;\n\n    for (let i = 0; i < listeners.length; i++) {\n      component = listeners[i].callback(context);\n\n      if (component) {\n        break;\n      }\n    }\n\n    return component;\n  }\n\n  getComponents(type, context) {\n    const listeners = this._listeners[type];\n\n    const components = [];\n\n    if (!listeners) {\n      return components;\n    }\n\n\n    for (let i = 0; i < listeners.length; i++) {\n      const component = listeners[i].callback(context);\n\n      if (component) {\n        components.push(component);\n      }\n    }\n\n    if (!components.length) {\n      return components;\n    }\n\n    return components;\n  }\n\n  onGetComponent(type, priority, callback) {\n    if (isFunction(priority)) {\n      callback = priority;\n      priority = DEFAULT_PRIORITY;\n    }\n\n    if (!isNumber(priority)) {\n      throw new Error('priority must be a number');\n    }\n\n    const listeners = this._getListeners(type);\n\n    let existingListener,\n        idx;\n\n    const newListener = { priority, callback };\n\n    for (idx = 0; (existingListener = listeners[idx]); idx++) {\n      if (existingListener.priority < priority) {\n\n        // prepend newListener at before existingListener\n        listeners.splice(idx, 0, newListener);\n        return;\n      }\n    }\n\n    listeners.push(newListener);\n  }\n\n  offGetComponent(type, callback) {\n    const listeners = this._getListeners(type);\n\n    let listener,\n        listenerCallback,\n        idx;\n\n    if (callback) {\n\n      // move through listeners from back to front\n      // and remove matching listeners\n      for (idx = listeners.length - 1; (listener = listeners[idx]); idx--) {\n        listenerCallback = listener.callback;\n\n        if (listenerCallback === callback) {\n          listeners.splice(idx, 1);\n        }\n      }\n    } else {\n\n      // clear listeners\n      listeners.length = 0;\n    }\n  }\n\n  _getListeners(type) {\n    let listeners = this._listeners[type];\n\n    if (!listeners) {\n      this._listeners[type] = listeners = [];\n    }\n\n    return listeners;\n  }\n}"],"mappings":"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"}